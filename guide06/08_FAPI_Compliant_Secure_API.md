# Chapter 08: FAPI準拠のセキュアなAPI

## 1. はじめに：オープン性とセキュリティのジレンマ

これまでの章で、私たちはオープンなAPIを通じて外部サービスと連携し、エコシステムを形成することの重要性を学びました。しかし、APIを外部に公開するということは、同時に新たな攻撃対象領域（アタックサーフェス）を生み出すことでもあります。

特に、顧客の大切な資産を預かる金融システムにおいては、最高レベルのセキュリティが要求されます。一般的なWebサイトで用いられるようなセキュリティ対策だけでは、巧妙化するサイバー攻撃からシステムを守り切ることはできません。

この、オープン性と堅牢なセキュリティという、一見すると相反する要求を両立させるための答えが、**FAPI (Financial-grade API)** です。

## 2. なぜ「普通のセキュリティ」では不十分なのか？

一般的なWeb APIで広く使われている認証・認可の仕組みに **OAuth 2.0** があります。これは非常に優れたフレームワークですが、それ単体では金融取引のような、より高いセキュリティが求められる場面においては、いくつかのリスクシナリオに対応しきれません。

**OAuth 2.0だけでは防ぎきれない攻撃の例:**
-   **認可コードの横取り**: 通信の途中で第三者が認可コードを盗み、正規のクライアントになりすましてアクセストークンを取得してしまう。
-   **アクセストークンの漏洩**: 漏洩したアクセストークンが、意図しないAPI（例：送金API）の呼び出しに使われてしまう。
-   **リプレイ攻撃**: 攻撃者が、一度傍受したリクエストをそのまま再送することで、不正な操作を繰り返す。

これらのリスクは、数百万、数千万という単位の金銭が動く金融トランザクションにおいては、決して許容できるものではありません。

## 3. FAPIとは何か？より強固なセキュリティプロファイル

FAPIは、この問題を解決するために策定された、OAuth 2.0の**セキュリティプロファイル**です。プロファイルとは、既存の標準（OAuth 2.0）の上に、より厳格なルールや拡張機能を付け加えた、いわば「強化版」の仕様書です。

FAPIは、金融サービスで安全にAPI連携を行うために、OAuth 2.0の曖昧な部分をなくし、より強力なセキュリティ機能を必須とすることを定めています。

**FAPIが要求する主な追加セキュリティ機能:**
-   **強固なクライアント認証**: 事前に登録された正規のクライアントアプリケーションしか通信を開始できないようにする。
-   **送信者制約 (Sender-Constrained Tokens)**: アクセストークンを発行する際に、そのトークンを利用できるクライアントを特定の1者に限定する仕組み（証明書バインディングなど）。これにより、万が一トークンが漏洩しても、攻撃者はそれを利用できません。
-   **リクエストの署名**: リクエスト全体に対して電子署名を行うことで、途中で改ざんされていないこと、そして正規のクライアントから送られたことを保証する。
-   **より安全な暗号スイートの強制**: 安全性が証明された、強度の高い暗号アルゴリズムのみを使用することを義務付ける。

これらの多層的な防御策を組み合わせることで、FAPIは金融取引に求められる極めて高いレベルのセキュリティを実現します。

## 4. FAPI準拠の重要性

FAPIに準拠することは、単にセキュリティを強化する以上の意味を持ちます。

-   **信頼の証**: FAPIに準拠していることは、パートナー企業や顧客に対して、自社のシステムが最高水準のセキュリティを備えていることを示す、信頼の証となります。
-   **グローバル標準**: FAPIは、英国のオープンバンキングや、オーストラリアのCDR（消費者データ権）など、世界中の先進的な金融APIエコシステムで標準仕様として採用されており、グローバルな相互運用性の基盤となります。
-   **規制遵守**: 今後、各国の規制当局が、金融機関のAPI連携においてFAPIレベルのセキュリティを要求する流れは加速していくと考えられます。

未来の金融プラットフォームを構築する上で、APIの設計段階からFAPIに準拠することは、もはやオプションではなく、**必須要件**であると言えるでしょう。

---
Part 3では、次世代金融システムを「いかにして実現するのか」を、クラウドネイティブ、DDD、連携パターン、そしてセキュリティという4つの側面から解説しました。

最終章となるPart 4では、これまでの学びを総括し、未来へ向けたロードマップを描いていきます。 